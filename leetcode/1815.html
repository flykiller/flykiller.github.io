<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 1807. Evaluate the Bracket Pairs of a String | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 1807. Evaluate the Bracket Pairs of a String" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/" />
<meta property="og:description" content="Problem statement https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-25T14:07:27+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 1807. Evaluate the Bracket Pairs of a String" />
<script type="application/ld+json">
{"url":"/leetcode/1815.html","@type":"BlogPosting","headline":"Leetcode 1807. Evaluate the Bracket Pairs of a String","dateModified":"2022-01-25T14:07:27+03:00","datePublished":"2022-01-25T14:07:27+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/1815.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/codeforces%20problems/">Codeforces problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/dfs"><code class="highligher-rouge"><nobr>dfs</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/math"><code class="highligher-rouge"><nobr>math</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/backtracking"><code class="highligher-rouge"><nobr>backtracking</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 1807. Evaluate the Bracket Pairs of a String</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-01-25T14:07:27+03:00" itemprop="datePublished">
        Jan 25, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>
<p><a href="https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/"> <font color="blue">https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/</font></a></p>

<h4 id="solution">Solution</h4>
<p>Quite difficult problem, we need to read problem restriction carefully to suceed. We can notice, that <code class="language-plaintext highlighter-rouge">B &lt;= 9</code> and this is the main point we will use.</p>

<ol>
  <li>Let us first understand, what our problem is about. We have bunch of nubmers and we need to make them in special order, such that as much groups are divisible by <code class="language-plaintext highlighter-rouge">B</code>. Notice, that what matters, is not element <code class="language-plaintext highlighter-rouge">g in groups</code>, but in fact <code class="language-plaintext highlighter-rouge">g % B</code>.</li>
  <li>Now, we have elements in groups be numbers from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">B-1</code>. Notice, that if we have element <code class="language-plaintext highlighter-rouge">0</code>, than this group is always happy, so no need to consider it: remove it and add <code class="language-plaintext highlighter-rouge">1</code> to final answer. Also, notice, that if we have two elements, which give <code class="language-plaintext highlighter-rouge">B</code> in total, if we put them one after another, we will make happy group as well.</li>
  <li>Let us call <code class="language-plaintext highlighter-rouge">position</code> how many of each reminders we have, for example for case <code class="language-plaintext highlighter-rouge">[1, 2, 3, 3, 4, 5, 5, 5]</code> and <code class="language-plaintext highlighter-rouge">B = 4</code>, we have <code class="language-plaintext highlighter-rouge">[4,1,2]</code>, because we have <code class="language-plaintext highlighter-rouge">4</code> numbers with reminder <code class="language-plaintext highlighter-rouge">1</code>, <code class="language-plaintext highlighter-rouge">1</code> number with reminder <code class="language-plaintext highlighter-rouge">2</code> and <code class="language-plaintext highlighter-rouge">2</code> numbers with reminder <code class="language-plaintext highlighter-rouge">3</code>.</li>
  <li>It is time now to use <code class="language-plaintext highlighter-rouge">dfs(position, last)</code>, where <code class="language-plaintext highlighter-rouge">position</code> is what we discussed earlier and <code class="language-plaintext highlighter-rouge">last</code> is last number in our sequence. Where we can go from this position: we try to decrease one of the elements of <code class="language-plaintext highlighter-rouge">position</code> by one and run function recursively: we add <code class="language-plaintext highlighter-rouge">1</code> (using <code class="language-plaintext highlighter-rouge">U == 0</code>), if we make one more group happy.</li>
  <li>In the end we just run our <code class="language-plaintext highlighter-rouge">dfs</code> from positions we created.</li>
</ol>

<h4 id="complexity">Complexity</h4>
<p>We have at most <code class="language-plaintext highlighter-rouge">O(K)</code>, where <code class="language-plaintext highlighter-rouge">K = B//2</code> non-zero elements in group and sum of all elements in groups is restricted by <code class="language-plaintext highlighter-rouge">n</code>. So we have no more than <code class="language-plaintext highlighter-rouge">(n/K)^K</code> possible positions here, which given problem restriction is quite small, so total time complexity is <code class="language-plaintext highlighter-rouge">O((n/K)^K*K)</code>, because we can have upto <code class="language-plaintext highlighter-rouge">K</code> transitions from one state to others. Space complexity is the same.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">maxHappyGroups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">groups</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">g</span><span class="o">%</span><span class="n">B</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">g</span><span class="o">%</span><span class="n">B</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span> <span class="n">pos</span><span class="p">[</span><span class="n">g</span><span class="o">%</span><span class="n">B</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="n">B</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">!=</span> <span class="n">B</span> <span class="o">-</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="n">t</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">t</span>
            <span class="n">pos</span><span class="p">[</span><span class="n">B</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-=</span> <span class="n">t</span>
            
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">ans</span>

        <span class="o">@</span><span class="n">lru_cache</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">last</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span>

            <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">"-inf"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">position</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">position</span><span class="p">]</span>
                    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="n">last</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="n">B</span>
                    <span class="n">ans</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">dfs</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">U</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
                      
            <span class="k">return</span> <span class="n">ans</span>

        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span> <span class="o">+</span> <span class="n">ans</span>
</code></pre></div></div>

<p>If you like the solution, you can <strong>upvote</strong> it on leetcode discussion section:<a href="https://leetcode.com/problems/maximum-number-of-groups-getting-fresh-donuts/discuss/1140548/Python-dfs-with-optimizations-explained"> <font color="blue">Problem 1815</font></a></p>

  </div><a class="u-url" href="/leetcode/1815.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>