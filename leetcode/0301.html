<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 0301. Remove Invalid Parentheses | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 0301. Remove Invalid Parentheses" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-14T17:31:04+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 0301. Remove Invalid Parentheses" />
<script type="application/ld+json">
{"url":"/leetcode/0301.html","@type":"BlogPosting","headline":"Leetcode 0301. Remove Invalid Parentheses","dateModified":"2022-01-14T17:31:04+03:00","datePublished":"2022-01-14T17:31:04+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/0301.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  
  
</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/codeforces%20problems/">Codeforces problems</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/backtracking"><code class="highligher-rouge"><nobr>backtracking</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/string"><code class="highligher-rouge"><nobr>string</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 0301. Remove Invalid Parentheses</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-01-14T17:31:04+03:00" itemprop="datePublished">
        Jan 14, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/remove-invalid-parentheses/"> <font color="blue">https://leetcode.com/problems/remove-invalid-parentheses/</font></a></p>

<h4 id="solution-1">Solution 1</h4>
<p>The idea is to use dfs with parematers</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">ind</code> - current symbol</li>
  <li><code class="language-plaintext highlighter-rouge">l</code> - number of <code class="language-plaintext highlighter-rouge">(</code> left to take,</li>
  <li><code class="language-plaintext highlighter-rouge">r</code> is number of <code class="language-plaintext highlighter-rouge">)</code> left to take</li>
  <li><code class="language-plaintext highlighter-rouge">built</code> is built string so far.</li>
</ol>

<p>Then we try to built element by element and check that we have good balance. Note, that we can in <code class="language-plaintext highlighter-rouge">O(n)</code> understand how many open and closing brackets we need: we need to iterate through our string and if we meet <code class="language-plaintext highlighter-rouge">(</code>, increase <code class="language-plaintext highlighter-rouge">lft</code> by one and if we se closing bracket and balance is zero, we do not do anything, if we have closing bracket and balance is positive, subtact one. What we have as <code class="language-plaintext highlighter-rouge">total</code> now in code is number of open and closed brackets we need to keep.</p>

<p>Note also that there is optimization if we use not <code class="language-plaintext highlighter-rouge">l</code> and r, but four parameters instead: number of brackets taken already and number of brackets need to be removed: in this way some of the options will be cut earlier: if we can not finish to built string, no need to continue.</p>

<h4 id="complexity">Complexity</h4>
<p>It is potentially <code class="language-plaintext highlighter-rouge">O(2^n)</code>, where <code class="language-plaintext highlighter-rouge">n</code> is length of string.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">removeInvalidParentheses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="n">lft</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">"("</span> <span class="p">:</span> <span class="n">lft</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s">")"</span> <span class="p">:</span> <span class="n">lft</span> <span class="o">-=</span> <span class="p">(</span><span class="n">lft</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
                
        <span class="n">total</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">"("</span><span class="p">)</span> <span class="o">-</span> <span class="n">lft</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">built</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ans</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">built</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span>
            
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">==</span> <span class="s">"("</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">built</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">built</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">==</span> <span class="s">")"</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">dfs</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">built</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">built</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dfs</span><span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">built</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                
        <span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>
</code></pre></div></div>

<h4 id="solution-2">Solution 2</h4>
<p>Let <code class="language-plaintext highlighter-rouge">dp(i, bal)</code> will return all solutions, which created from string <code class="language-plaintext highlighter-rouge">(i -&gt; end)</code> and having balance of open and closing brackets equal to <code class="language-plaintext highlighter-rouge">bal</code>.</p>

<ol>
  <li>If we reached the end of the string and balance is zero, we return <code class="language-plaintext highlighter-rouge">""</code> solution.</li>
  <li>If balance is negative or we reached the end of string, there is no solution possible with this situation, no matter what was before.</li>
  <li>Then, we need to consider two options: first one when we add new symbol, then we update solution as <code class="language-plaintext highlighter-rouge">s[i] + suff</code> for every suffix <code class="language-plaintext highlighter-rouge">suff in dp(i + 1, bal1)</code>, where <code class="language-plaintext highlighter-rouge">bal1</code> is new balance.</li>
  <li>Second is when we do not take symbol, we can do it only if we have bracket <code class="language-plaintext highlighter-rouge">(</code> or <code class="language-plaintext highlighter-rouge">)</code>, not letter. We add it to our answer as well.</li>
  <li>Finally, we evaluate <code class="language-plaintext highlighter-rouge">dp(0, 0)</code> and choose all elements with maximum length.</li>
</ol>

<h4 id="complexity-1">Complexity</h4>
<p>It is still <code class="language-plaintext highlighter-rouge">O(2^n)</code></p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">removeInvalidParentheses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="o">@</span><span class="n">lru_cache</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">dp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">bal</span><span class="p">):</span> 
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">bal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="s">""</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">bal</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">bal1</span> <span class="o">=</span> <span class="n">bal</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">"("</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">")"</span><span class="p">)</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">suff</span> <span class="k">for</span> <span class="n">suff</span> <span class="ow">in</span> <span class="n">dp</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bal1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="s">'()'</span><span class="p">:</span> <span class="n">ans</span> <span class="o">|=</span> <span class="n">dp</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bal</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ans</span>

        <span class="n">valid</span> <span class="o">=</span> <span class="n">dp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">maxLen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">valid</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="nb">len</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">maxLen</span><span class="p">)]</span>
</code></pre></div></div>

  </div><a class="u-url" href="/leetcode/0301.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>