<!DOCTYPE html>
<html lang="en"><head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Leetcode 0752. Open the Lock | Dmitry Babichev’s webpage</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Leetcode 0752. Open the Lock" />
<meta name="author" content="Dmitry Babichev" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Problem statement" />
<meta property="og:description" content="Problem statement" />
<meta property="og:site_name" content="Dmitry Babichev’s webpage" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-20T21:47:40+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Leetcode 0752. Open the Lock" />
<script type="application/ld+json">
{"url":"/leetcode/0752.html","@type":"BlogPosting","headline":"Leetcode 0752. Open the Lock","dateModified":"2022-02-20T21:47:40+03:00","datePublished":"2022-02-20T21:47:40+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"/leetcode/0752.html"},"author":{"@type":"Person","name":"Dmitry Babichev"},"description":"Problem statement","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Dmitry Babichev's webpage" />
    






  



</head>

    
    <!-- for mathjax support -->
    
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dmitry Babichev&#39;s webpage</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/codeforces%20problems/">Codeforces</a><a class="page-link" href="/leetcode%20problems/">Leetcode problems</a><a class="page-link" href="/binarysearch%20problems/">BinarySearch</a><a class="page-link" href="/coding%20ideas/">Patterns</a><a class="page-link" href="/performance%20tricks/">Speed up</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <span>[
  
    
    <a href="/tag/bfs"><code class="highligher-rouge"><nobr>bfs</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/graph"><code class="highligher-rouge"><nobr>graph</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/graph-algo"><code class="highligher-rouge"><nobr>graph-algo</nobr></code>&nbsp;</a>
  
]</span>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Leetcode 0752. Open the Lock</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-02-20T21:47:40+03:00" itemprop="datePublished">
        Feb 20, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="problem-statement">Problem statement</h4>

<p><a href="https://leetcode.com/problems/open-the-lock/"> <font color="blue">https://leetcode.com/problems/open-the-lock/</font></a></p>

<h4 id="solution-1-usual-bfs">Solution 1: Usual bfs</h4>

<p>We can look at this problem as graph problem, where we need to find shortest way between given two nodes. We can do classical bfs to do it.</p>

<h4 id="complexity">Complexity</h4>
<p>The worst time complexity is <code class="language-plaintext highlighter-rouge">O(E)</code>, where <code class="language-plaintext highlighter-rouge">E</code> is number of edges and it can be <code class="language-plaintext highlighter-rouge">10000 * 8/2</code>, because we have <code class="language-plaintext highlighter-rouge">10000</code> nodes and each node is connected with <code class="language-plaintext highlighter-rouge">8</code> others. Space complexity <code class="language-plaintext highlighter-rouge">O(N)</code>, where <code class="language-plaintext highlighter-rouge">N</code> is size of <code class="language-plaintext highlighter-rouge">deadends</code>.</p>

<h4 id="code">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">openLock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deadends</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        
        <span class="n">dead</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">deadends</span><span class="p">)</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"0000"</span><span class="p">)])</span>
        
        <span class="k">if</span> <span class="s">"0000"</span> <span class="ow">in</span> <span class="n">dead</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">steps</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">target</span><span class="p">:</span> <span class="k">return</span> <span class="n">steps</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">cand</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dead</span><span class="p">:</span> 
                        <span class="n">dead</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">cand</span><span class="p">)</span>
                        <span class="n">queue</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cand</span><span class="p">))</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<h4 id="solution-2-bidirectional-bfs">Solution 2: Bidirectional bfs</h4>

<p>There is also bidirectional bfs, which has the same worst time complexity, but which in average will work several times faster. The idea is to start from both ends and each time choose the end with smaller size of queue. Here we need to be careful: Our invariant, that at each moment of time in our queues we have number of steps (first elements):</p>

<p><code class="language-plaintext highlighter-rouge">[i,i,..., i, i+1, i+1, ..., i+1]</code> and  <code class="language-plaintext highlighter-rouge">[j,j,..., j, j+1, j+1, ..., j+1]</code></p>

<p>We extract left element from first queue and we need to check if it is in second. At this moment we for sure know that distance is not more than <code class="language-plaintext highlighter-rouge">i + j</code>. However, it can be either <code class="language-plaintext highlighter-rouge">i+j</code> or <code class="language-plaintext highlighter-rouge">i+j+1</code>, and we need to check all elements with length <code class="language-plaintext highlighter-rouge">i</code> to mare sure there is no element from second queue with steps <code class="language-plaintext highlighter-rouge">j</code>. So, first time we see that sum of first elements from our queue is more than <code class="language-plaintext highlighter-rouge">limit</code>, it means that we finished to process all candidates, so we can return answer.</p>

<h4 id="remark">Remark</h4>
<p>In this specific problem, because of bipartite structure of our graph, bidirectional bfs can be optimized: for given <code class="language-plaintext highlighter-rouge">i</code> it can happen than only <code class="language-plaintext highlighter-rouge">j</code> or <code class="language-plaintext highlighter-rouge">j+1</code> is in visited set, but not both of them, so 2 lines when we check <code class="language-plaintext highlighter-rouge">limit</code> can be removed. However in this case alrorithm become less universal, so I prefer it as it is, so you can reuse this pattern in other problems. Actually I already used it in some other problem, but I do not remember what exacty, please let me know if you have any idea.</p>

<h4 id="complexity-1">Complexity</h4>
<p>Is the same as previous approach, but in practice it works much faster.</p>

<h4 id="code-1">Code</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">openLock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deadends</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="n">dead</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">deadends</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">"0000"</span> <span class="ow">in</span> <span class="n">dead</span><span class="p">:</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        
        <span class="n">queue1</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"0000"</span><span class="p">)])</span>
        <span class="n">queue2</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="n">target</span><span class="p">)])</span>
        <span class="n">visited1</span> <span class="o">=</span> <span class="p">{</span><span class="s">"0000"</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">visited2</span> <span class="o">=</span> <span class="p">{</span><span class="n">target</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        
        <span class="n">limit</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s">"inf"</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">queue1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue2</span><span class="p">):</span>
                <span class="n">queue1</span><span class="p">,</span> <span class="n">queue2</span> <span class="o">=</span> <span class="n">queue2</span><span class="p">,</span> <span class="n">queue1</span>
                <span class="n">visited1</span><span class="p">,</span> <span class="n">visited2</span> <span class="o">=</span> <span class="n">visited2</span><span class="p">,</span> <span class="n">visited1</span>
                
            <span class="n">steps</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">queue1</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">queue2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">limit</span><span class="p">:</span> <span class="k">return</span> <span class="n">ans</span>
            
            <span class="k">if</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">visited2</span><span class="p">:</span>
                <span class="n">limit</span> <span class="o">=</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">queue2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">visited1</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">+</span> <span class="n">visited2</span><span class="p">[</span><span class="n">code</span><span class="p">],</span> <span class="n">ans</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">cand</span> <span class="o">=</span> <span class="n">code</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">if</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited1</span> <span class="ow">and</span> <span class="n">cand</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dead</span><span class="p">:</span>
                        <span class="n">visited1</span><span class="p">[</span><span class="n">cand</span><span class="p">]</span> <span class="o">=</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span>
                        <span class="n">queue1</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cand</span><span class="p">))</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

  </div><a class="u-url" href="/leetcode/0752.html" hidden></a>
</article>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Dmitry Babichev</li>
          <li><a class="u-email" href="mailto:dimitry008@gmail.com">dimitry008@gmail.com</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Here you can find solution to some algorithmic problems, at the moment it is mainly leetcode problems.
</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body><script async src="https://www.googletagmanager.com/gtag/js?id=G-KR1GZKF62P"></script>
<script>
  window['ga-disable-G-KR1GZKF62P'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KR1GZKF62P');
</script>
</html>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>